let nowDate=moment().format("YYYYMMDDTHHmm"),apioff=!1,recentItem=null,locationList={},lastUpdate={};function data_List(t,e){try{const a=document.getElementById(t);if(a)if($(a).children().remove(),e.length>0)e.forEach(t=>{let e=t.channelName.split("_"),o=e.length>1?e[0]+" CH."+e[1]:t.channelName;const n=document.createElement("li");n.className="list-group-item item-location",n.innerHTML=`${o}<span>${t.date}</span>`,a.appendChild(n)});else{const t=document.createElement("li");t.className="list-group-item item-location",t.innerHTML="최근 획득 정보가 없습니다.",a.appendChild(t)}}catch(t){console.error(t)}}function loadingToggle(t=!0){t?($("#loadingScreen").css("height",$(document).height()),$("#loadingScreen").addClass("active"),$("#btn_search").addClass("disabled")):($("#loadingScreen").removeClass("active"),$("#btn_search").removeClass("disabled"))}function delayUpdate(t){return!!(lastUpdate[t]&&Date.now()-lastUpdate[t]<6e4)&&(locationList[t]&&(data_List("dropRecent",locationList[t].drop),data_List("potRecent",locationList[t].pot)),!0)}$(document).ready(function(){if("0"===sessionStorage.getItem("serverState"))return toast("warning","DFGEAR 서버 점검");function t(t){if(t)return apioff||"0"===sessionStorage.getItem("serverState")?toast("warning","DFGEAR 서버 점검"):void(delayUpdate(t)||(locationList[t]||(locationList[t]={drop:[],pot:[]}),function(t){if(!delayUpdate(t))apioff||"0"===sessionStorage.getItem("serverState")?toast("warning","DFGEAR 서버 점검"):callGearAPI("/item/recentSearchDrop",{inc:t},function(e,a){if(loadingToggle(!1),a){if(!e.responseText)return console.log(a),console.log(e),alert("에러 발생");checkError(e.responseText)}else locationList[t].drop=e.data,data_List("dropRecent",e.data)})}(t),function(t){if(!delayUpdate(t))apioff||"0"===sessionStorage.getItem("serverState")?toast("warning","DFGEAR 서버 점검"):callGearAPI("/item/recentSearchPot",{inc:t},function(e,a){if(loadingToggle(!1),a){if(!e.responseText)return console.log(a),console.log(e),alert("에러 발생");checkError(e.responseText)}else locationList[t].pot=e.data,data_List("potRecent",e.data)})}(t),lastUpdate[t]=Date.now()));toast("info","아이템을 선택해주세요.")}$(document).on("click","#btn_lightmode",function(t){ligthModeChange(t.target)}),$(document).on("click",".row.title",function(){try{location.href="./"}catch(t){sessionStorage.clear(),location.href="https://dfgear.xyz"}}),$(window).resize(function(){$("#loadingScreen").css("height",$(document).height())}),$("#btn_wp").on("click",function(t){$(".tabArea > .custom-btn").removeClass("active"),$(".tabContent > div").removeClass("show"),$(t.target).addClass("active"),$("#tab_wp").addClass("show")}),$("#btn_set").on("click",function(t){$(".tabArea > .custom-btn").removeClass("active"),$(".tabContent > div").removeClass("show"),$(t.target).addClass("active"),$("#tab_set").addClass("show")}),$("#tab_job > div > button").on("click",function(t){$("#tab_job > div > button").removeClass("active"),$("#content_wp > div > div").removeClass("show"),$(t.target).addClass("active"),$(`#wp_${$(t.target).attr("data-cd")}`).addClass("show")}),$(".tabContent .flgap > div").on("click",function(e){try{let a;const o=$(e.target);if(o.is("img")){const t=o.closest("div");if(t.hasClass("on"))return;$(".tabContent .flgap > div").removeClass("on"),t.addClass("on"),$("#txt_searchItem").text(t.attr("title")),a=t.attr("data-id")}else{if(o.hasClass("on"))return;$(".tabContent .flgap > div").removeClass("on"),o.addClass("on"),$("#txt_searchItem").text(o.attr("title")),a=o.attr("data-id")}recentItem||($("#contentRecent").addClass("show"),$("#txt_itemName").addClass("show")),recentItem=a,t(a)}catch(t){console.error(t)}}),$(document).on("click","#locationRefresh",function(){delayUpdate(recentItem)?toast("info","해당 아이템은 1분 이내에 갱신되었습니다."):t(recentItem)})});